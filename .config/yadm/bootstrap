#/bin/bash

curl -L https://nixos.org/nix/install | sh
  . /home/$USER/.nix-profile/etc/profile.d/nix.sh
  
nix-channel --add https://github.com/nix-community/home-manager/archive/master.tar.gz home-manager
nix-channel --update

nix-shell '<home-manager>' -A install

home-manager switch

YADM_FOLDER=$HOME/.config/yadm

for script in $YADM_FOLDER/tools/**/install.sh; do
  if [[ -f "$script" ]]; then
    echo "Running $script"
    sh "$script"
  fi
done

sh $YADM_FOLDER/theme/install.sh

STARTUP_FILE="$HOME/.config/yadm/startup.sh"
# Check if yadm startup is added to .bashrc if not add it 
cat $HOME/.bashrc | grep $STARTUP_FILE
if [[ $? -ne 0 ]]; then
       echo "source $STARTUP_FILE" >> $HOME/.bashrc
fi
